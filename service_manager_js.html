<script>
  function initData() {
    let oData = {
      TopFlexBoxBusy: true,
      DDStore:        [],
      DDIngre:        [],
      GroceryList:    []
    }

    return oData;
  }

  
  function getViewContent(oViewID) {
    return new Promise (function (resolve,reject) {
      // google.script.run: interact with server side scripts

      google.script.run.withSuccessHandler(function(oFileContent) {
        resolve(oFileContent);
      }).fileRead(oViewID);
    })
  }


  function removeLoadingScreen() {
    let load_screen = document.getElementById("load_screen");
    document.body.removeChild(load_screen);    
  }


  function getRangeData(pSheet, pRange, pFieldName, pLastRow) {
    return new Promise(function(resolve, reject) {
      google.script.run.withSuccessHandler((pDataArray) => {
        resolve(pDataArray);
      }).getRangeData(pSheet, pRange, pFieldName, pLastRow);
    })
  }


  function getIngridentsPerStore(pStore) {
    return new Promise(function(resolve, reject) {
      google.script.run.withSuccessHandler((pDataArray) => {
        resolve(pDataArray);
      }).getIngredientsPerStore(pStore);
    })
  }


  function appendGroceryToSheet(pSheet, pDataArray) {
    return new Promise(function(resolve, reject) {
      google.script.run.withSuccessHandler((pDataArray) => {
        resolve(pDataArray);
      }).appendGroceryToSheet(pSheet, pDataArray);
    })
  }


  function retrieveGrocery(pSheet) {
    return new Promise(function(resolve, reject) {
      google.script.run.withSuccessHandler((pDataArray) => {
        resolve(pDataArray);
      }).retrieveGrocery(pSheet);
    })
  }


  function insertOneRowInGroceryHistory(pSheet, pRowIndex) {
    return new Promise(function(resolve, reject) {
      google.script.run.withSuccessHandler((pDataArray) => {
        resolve(pDataArray);
      }).insertOneRowInGroceryHistory(pSheet, pRowIndex);
    })
  }


  function retrieveGroceryHistory(pSheet) {
    return new Promise(function(resolve, reject) {
      google.script.run.withSuccessHandler((pDataArray) => {
        resolve(pDataArray);
      }).retrieveGroceryHistory(pSheet);
    })
  }


  function moveGroceryToHistory(pGrocerySheet, pRowToDelete, pHistorySheet, pRowToInsert) {
    return new Promise(function(resolve, reject) {
      google.script.run.withSuccessHandler((pDataArray) => {
        resolve(pDataArray);
      }).moveGroceryToHistory(pGrocerySheet, pRowToDelete, pHistorySheet, pRowToInsert);
    })
  }
</script>